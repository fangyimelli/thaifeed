:root {
  font-family: 'Noto Sans TC', system-ui, sans-serif;
  color: #f6f6f6;
  background: #0f1117;
}

* { box-sizing: border-box; }
body { margin: 0; }

.app-layout {
  height: 100vh;
  display: grid;
  grid-template-columns: 1fr 390px;
  gap: 12px;
  padding: 12px;
  position: relative;
}

.scene-view {
  position: relative;
  overflow: hidden;
  border-radius: 12px;
  border: 1px solid #2b3140;
  background: #05070c;
}
.scene-video, .overlay {
  position: absolute;
  width: 100%;
  height: 100%;
  object-fit: cover;
  inset: 0;
}
.overlay { pointer-events: none; }
.overlay.noise { opacity: .12; mix-blend-mode: screen; }
.overlay.smoke { opacity: .25; }
.overlay.crack { opacity: .12; }
.overlay.vignette { opacity: .7; }

.glyph-blink {
  position: absolute;
  right: 19%;
  top: 30%;
  color: rgba(178, 231, 255, 0.95);
  text-shadow: 0 0 20px rgba(134, 217, 255, 0.95), 0 0 50px rgba(88, 162, 255, 0.75);
  font-size: 58px;
  font-weight: 700;
  font-family: 'Noto Sans Thai', 'Noto Sans TC', sans-serif;
  animation: glyphBlink 1.2s ease-in-out infinite;
}

.scene-hud {
  position: absolute;
  left: 14px;
  top: 14px;
  background: rgba(0, 0, 0, .35);
  backdrop-filter: blur(4px);
  padding: 10px 12px;
  border-radius: 10px;
}
.scene-hud h1 { margin: 0 0 6px; font-size: 20px; }

.curse-meter { display: flex; align-items: center; gap: 8px; margin-top: 8px; }
.curse-meter .bar { width: 140px; height: 8px; background: #262b38; border-radius: 99px; overflow: hidden; }
.curse-meter .fill { height: 100%; background: linear-gradient(90deg,#62d2a2,#f2a347,#ed4b6a); }

.chat-panel {
  background: #0f1115;
  border: 1px solid #2d2f35;
  border-radius: 12px;
  display: flex;
  flex-direction: column;
  height: calc(100vh - 24px);
  overflow: hidden;
}
.chat-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 12px;
  border-bottom: 1px solid #2b2d33;
  font-size: 13px;
  background: #17191f;
}
.chat-header span { color: #a5abb8; }

.chat-list {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  scrollbar-width: thin;
}
.chat-message {
  font-size: 14px;
  line-height: 1.4;
}
.chat-line {
  display: flex;
  gap: 6px;
  align-items: flex-start;
}
.name {
  font-weight: 700;
  display: inline-flex;
  align-items: center;
  gap: 5px;
  color: #8ab4f8;
  white-space: nowrap;
}
.msg {
  color: #f1f3f4;
  word-break: break-word;
}
.translation {
  margin: 4px 0 0 22px;
  color: #9ecbff;
  font-size: 13px;
}
.crown { width: 14px; height: 14px; }
.vip.VIP_NORMAL .name { color: #f7d87b; }
.vip.VIP_STILL_HERE .name { color: #c9b8ff; }

.translation-toggle {
  border: 1px solid #414b64;
  background: transparent;
  color: #c9d8ff;
  font-size: 11px;
  border-radius: 4px;
  cursor: pointer;
  padding: 1px 5px;
  margin-left: auto;
}

.jump-bottom {
  align-self: center;
  margin: 6px 0 8px;
  border: none;
  border-radius: 14px;
  padding: 4px 12px;
  font-size: 12px;
  background: #2f6eff;
  color: #fff;
  cursor: pointer;
}

.chat-input {
  display: flex;
  gap: 8px;
  padding: 10px;
  border-top: 1px solid #2b2d33;
  background: #17191f;
}
.chat-input input {
  flex: 1;
  background: #0c0e12;
  border: 1px solid #343844;
  border-radius: 18px;
  color: #fff;
  padding: 9px 12px;
}
.chat-input button {
  border: none;
  border-radius: 18px;
  padding: 0 14px;
  background: #3ea6ff;
  color: #071d2d;
  font-weight: 700;
  cursor: pointer;
}

.donate-stack {
  position: absolute;
  right: 410px;
  top: 20px;
  display: grid;
  gap: 10px;
}
.donate-toast {
  width: 330px;
  background: rgba(23,30,44,.92);
  border: 1px solid #60749b;
  border-radius: 10px;
  padding: 10px;
  animation: fadein .25s ease;
}
.donate-toast header { display: flex; align-items: center; gap: 8px; }
.donate-toast .translation { color: #b9d0ff; margin-left: 0; }

@keyframes fadein { from { opacity: 0; transform: translateY(-4px);} to { opacity: 1; transform: translateY(0);} }
@keyframes shake {
  0%,100% { transform: translate(0,0); }
  25% { transform: translate(-1px, 1px); }
  75% { transform: translate(1px, -1px); }
}
@keyframes glitch { 0%,100% { opacity: 1; } 50% { opacity: .65; } }
@keyframes glyphBlink { 0%,100% { opacity: .18; } 35% { opacity: 1; } 65% { opacity: .25; } }

.scene-view.curse-low .overlay.noise { opacity: .14; }
.scene-view.curse-mid { filter: blur(1px); }
.scene-view.curse-mid .overlay.noise { opacity: .25; }
.scene-view.curse-high { filter: blur(2px); animation: shake .16s infinite; }
.scene-view.curse-critical {
  filter: blur(2px) hue-rotate(8deg);
  animation: shake .12s infinite, glitch .45s infinite;
}
