:root {
  font-family: 'Noto Sans TC', system-ui, sans-serif;
  color: #f6f6f6;
  background: #0f1117;
}

* { box-sizing: border-box; }
body { margin: 0; }

.app-layout {
  height: 100vh;
  display: grid;
  grid-template-columns: 1fr 390px;
  gap: 12px;
  padding: 12px;
  position: relative;
}

.scene-view {
  position: relative;
  overflow: hidden;
  border-radius: 12px;
  border: 1px solid #2b3140;
  background: #05070c;
}
.scene-video, .overlay {
  position: absolute;
  width: 100%;
  height: 100%;
  object-fit: cover;
  inset: 0;
}
.overlay { pointer-events: none; }
.overlay.noise { opacity: .12; mix-blend-mode: screen; }
.overlay.smoke { opacity: .25; }
.overlay.crack { opacity: .12; }
.overlay.vignette { opacity: .7; }

.glyph-blink {
  position: absolute;
  color: rgba(182, 236, 255, 0.98);
  text-shadow: 0 0 22px rgba(134, 217, 255, 0.95), 0 0 54px rgba(88, 162, 255, 0.75);
  font-size: clamp(64px, 6.6vw, 92px);
  line-height: 1;
  font-weight: 700;
  font-family: 'Noto Sans Thai', 'Noto Sans TC', sans-serif;
  transform: translate(-50%, -50%);
  animation: glyphPulse 1.1s ease-in-out infinite;
  pointer-events: none;
}


.scene-hud {
  position: absolute;
  left: 14px;
  top: 14px;
  background: rgba(0, 0, 0, .35);
  backdrop-filter: blur(4px);
  padding: 10px 12px;
  border-radius: 10px;
}
.scene-hud h1 { margin: 0 0 6px; font-size: 20px; }

.curse-meter { display: flex; align-items: center; gap: 8px; margin-top: 8px; }
.curse-meter .bar { width: 140px; height: 8px; background: #262b38; border-radius: 99px; overflow: hidden; }
.curse-meter .fill { height: 100%; background: linear-gradient(90deg,#62d2a2,#f2a347,#ed4b6a); }

.chat-panel {
  background: #111316;
  border: 1px solid #2b2d31;
  border-radius: 12px;
  display: flex;
  flex-direction: column;
  height: calc(100vh - 24px);
  overflow: hidden;
  position: relative;
}
.chat-header {
  display: flex;
  align-items: center;
  padding: 10px 12px;
  border-bottom: 1px solid #2b2d33;
  font-size: 13px;
  background: #1a1c21;
}

.chat-list {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  scrollbar-width: thin;
}

.chat-items {
  margin-top: auto;
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.chat-message {
  font-size: 14px;
  line-height: 1.42;
  padding: 3px 2px;
  border-radius: 6px;
}
.chat-message:hover {
  background: rgba(255,255,255,0.03);
}
.chat-line {
  display: flex;
  gap: 6px;
  align-items: flex-start;
}
.name {
  font-weight: 700;
  display: inline-flex;
  align-items: center;
  gap: 5px;
  color: #8ab4f8;
  white-space: nowrap;
}
.msg {
  color: #f1f3f4;
  word-break: break-word;
  flex: 1;
}
.translation-actions {
  margin: 2px 0 0 22px;
}
.translation {
  margin: 3px 0 0 22px;
  color: #9ecbff;
  font-size: 13px;
}
.crown { width: 14px; height: 14px; }
.vip.VIP_NORMAL .name { color: #f7d87b; }
.vip.VIP_STILL_HERE .name { color: #c9b8ff; }
.chat-message.self .name { color: #8cffc4; }
.chat-message.self .msg { color: #dfffea; }

.translation-toggle {
  border: 1px solid #414b64;
  background: transparent;
  color: #c9d8ff;
  font-size: 11px;
  border-radius: 4px;
  cursor: pointer;
  padding: 1px 6px;
}

.jump-bottom {
  position: absolute;
  right: 14px;
  bottom: 72px;
  border: none;
  border-radius: 14px;
  padding: 5px 12px;
  font-size: 12px;
  background: #2f6eff;
  color: #fff;
  cursor: pointer;
  z-index: 2;
}

.chat-input {
  display: flex;
  gap: 8px;
  padding: 10px;
  border-top: 1px solid #2b2d33;
  background: #17191f;
}
.chat-input input {
  flex: 1;
  background: #0c0e12;
  border: 1px solid #343844;
  border-radius: 18px;
  color: #fff;
  padding: 9px 12px;
}
.chat-input button {
  border: none;
  border-radius: 18px;
  padding: 0 14px;
  background: #3ea6ff;
  color: #071d2d;
  font-weight: 700;
  cursor: pointer;
}

.donate-stack {
  position: absolute;
  right: 410px;
  top: 20px;
  display: grid;
  gap: 10px;
}
.donate-toast {
  width: 330px;
  background: rgba(23,30,44,.92);
  border: 1px solid #60749b;
  border-radius: 10px;
  padding: 10px;
  animation: fadein .25s ease;
}
.donate-toast header { display: flex; align-items: center; gap: 8px; }
.donate-toast .translation { color: #b9d0ff; margin-left: 0; }

.asset-warning {
  position: absolute;
  left: 14px;
  bottom: 14px;
  background: rgba(117, 24, 24, 0.85);
  color: #ffdcdc;
  border: 1px solid #ff8f8f;
  border-radius: 8px;
  padding: 8px 10px;
  font-size: 12px;
  z-index: 3;
}

.asset-warning code {
  color: #fff;
}
@keyframes fadein { from { opacity: 0; transform: translateY(-4px);} to { opacity: 1; transform: translateY(0);} }
@keyframes shake {
  0%,100% { transform: translate(0,0); }
  25% { transform: translate(-1px, 1px); }
  75% { transform: translate(1px, -1px); }
}
@keyframes glitch { 0%,100% { opacity: 1; } 50% { opacity: .65; } }
@keyframes glyphPulse { 0%,100% { opacity: .2; } 40% { opacity: 1; } 70% { opacity: .35; } }

.scene-view.curse-low .overlay.noise { opacity: .14; }
.scene-view.curse-mid { filter: blur(1px); }
.scene-view.curse-mid .overlay.noise { opacity: .25; }
.scene-view.curse-high { filter: blur(2px); animation: shake .16s infinite; }
.scene-view.curse-critical {
  filter: blur(2px) hue-rotate(8deg);
  animation: shake .12s infinite, glitch .45s infinite;
}

.loading-screen {
  min-height: 100vh;
  display: grid;
  place-items: center;
  background: #050607;
}

.loading-panel {
  width: min(460px, calc(100vw - 32px));
  padding: 28px 24px;
  border: 1px solid #2d3448;
  border-radius: 14px;
  background: rgba(10, 12, 16, 0.88);
  box-shadow: 0 0 36px rgba(98, 170, 255, 0.18);
}

.loading-panel h1 {
  margin: 0;
  font-size: 28px;
  text-align: center;
  letter-spacing: 1px;
}

.loading-progress-text {
  margin: 12px 0;
  text-align: center;
  font-size: 18px;
  color: #b9d9ff;
  text-shadow: 0 0 14px rgba(98, 170, 255, 0.45);
}

.loading-progress-track {
  width: 100%;
  height: 12px;
  border-radius: 999px;
  border: 1px solid #3c4761;
  background: #131822;
  overflow: hidden;
}

.loading-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #62d2a2, #7da8ff);
  transition: width 0.25s ease;
  box-shadow: 0 0 16px rgba(125, 168, 255, 0.75);
}


.loading-hint {
  margin-top: 12px;
  color: #d5e6ff;
  font-size: 13px;
  text-align: center;
}

.loading-error-box {
  margin-top: 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
}

.loading-error-box p {
  margin: 0;
  color: #ffbbbb;
  font-size: 13px;
}

.loading-error-box button {
  border: 1px solid #5b6888;
  border-radius: 8px;
  background: #1b253b;
  color: #d9e6ff;
  cursor: pointer;
  padding: 6px 12px;
}

@media (max-width: 1100px) {
  .app-layout {
    grid-template-columns: 1fr 340px;
    gap: 10px;
    padding: 10px;
  }

  .donate-stack {
    right: 356px;
    top: 14px;
  }

  .donate-toast {
    width: min(300px, 42vw);
  }
}

@media (max-width: 860px) {
  .app-layout {
    min-height: 100dvh;
    height: auto;
    grid-template-columns: 1fr;
    grid-template-rows: minmax(42dvh, 52dvh) minmax(40dvh, 1fr);
    gap: 10px;
    padding: 10px;
  }

  .scene-view,
  .chat-panel {
    border-radius: 10px;
  }

  .chat-panel {
    height: auto;
    min-height: 40dvh;
  }

  .chat-list {
    max-height: 48dvh;
  }

  .scene-hud h1 {
    font-size: 18px;
  }

  .glyph-blink {
    font-size: clamp(52px, 13vw, 84px);
  }

  .donate-stack {
    left: 10px;
    right: 10px;
    top: 12px;
    justify-items: end;
    pointer-events: none;
  }

  .donate-toast {
    width: min(92vw, 330px);
    pointer-events: auto;
  }

  .loading-panel {
    padding: 24px 18px;
  }

  .loading-panel h1 {
    font-size: 24px;
  }
}

@media (max-width: 480px) {
  .app-layout {
    padding: 8px;
    gap: 8px;
    grid-template-rows: minmax(38dvh, 46dvh) minmax(44dvh, 1fr);
  }

  .scene-hud {
    left: 10px;
    top: 10px;
    padding: 8px 10px;
  }

  .chat-header {
    padding: 9px 10px;
  }

  .chat-input {
    padding: 8px;
    gap: 6px;
  }

  .chat-input input {
    padding: 8px 10px;
  }

  .chat-input button {
    padding: 0 12px;
  }

  .loading-progress-text {
    font-size: 16px;
  }
}

.optional-asset-warning {
  position: absolute;
  left: 50%;
  top: 16px;
  transform: translateX(-50%);
  z-index: 6;
  display: flex;
  align-items: center;
  gap: 10px;
  background: rgba(28, 36, 54, 0.92);
  border: 1px solid #6279a8;
  color: #d7e6ff;
  border-radius: 999px;
  padding: 8px 12px;
  font-size: 13px;
  box-shadow: 0 0 20px rgba(80, 140, 255, 0.2);
}

.optional-asset-warning button {
  border: 1px solid #6f85b1;
  border-radius: 999px;
  background: rgba(15, 22, 38, 0.95);
  color: #d7e6ff;
  cursor: pointer;
  padding: 2px 10px;
  font-size: 12px;
}

@media (max-width: 860px) {
  .optional-asset-warning {
    max-width: calc(100vw - 24px);
    width: max-content;
    flex-wrap: wrap;
    justify-content: center;
    text-align: center;
    border-radius: 12px;
  }
}
