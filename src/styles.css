:root {
  font-family: 'Noto Sans TC', system-ui, sans-serif;
  color: #f6f6f6;
  background: #0f1117;
}

* { box-sizing: border-box; }
html,
body {
  margin: 0;
  height: 100%;
  overflow: hidden;
}

#root {
  min-height: 100dvh;
  min-height: 100svh;
  height: 100dvh;
  height: 100svh;
  overflow: hidden;
}

.app-shell {
  height: 100dvh;
  height: 100svh;
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  position: relative;
}

.app-layout {
  flex: 1;
  min-height: 0;
  display: flex;
  flex-direction: column;
  gap: 12px;
}


.loading-overlay {
  position: fixed;
  inset: 0;
  z-index: 2000;
  display: grid;
  place-items: center;
  background: #090b10;
}

.loading-overlay-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  color: #fff;
  text-align: center;
}

.loading-overlay-content p {
  margin: 0;
  font-size: 14px;
  line-height: 1.4;
  letter-spacing: 0;
}

.loading-spinner {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  border: 2px solid rgba(255, 255, 255, 0.24);
  border-top-color: #fff;
  animation: loadingSpin 0.9s linear infinite;
}

.video-container {
  flex: 0 0 auto;
  width: 100%;
  aspect-ratio: 16 / 9;
  min-height: 0;
  position: relative;
  contain: layout paint;
}

.chat-container {
  flex: 1;
  min-height: 0;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.scene-view {
  position: relative;
  overflow: hidden;
  border-radius: 12px;
  border: 1px solid #2b3140;
  background: #05070c;
  width: 100%;
  height: 100%;
}

.video-layer-wrapper {
  position: relative;
  width: 100%;
  height: 100%;
  overflow: hidden;
}

.scene-video-layer {
  position: absolute;
  inset: 0;
}

.scene-video, .overlay {
  position: absolute;
  width: 100%;
  height: 100%;
  inset: 0;
}
.scene-video {
  object-fit: contain;
  display: block;
  transition: opacity 420ms ease-in-out;
  opacity: 0;
  pointer-events: none;
}
#videoA.is-active,
#videoB.is-active {
  opacity: 1;
}
.overlay {
  object-fit: cover;
}
.overlay { pointer-events: none; }


.overlay.noise { opacity: .12; mix-blend-mode: screen; z-index: 12; }
.overlay.smoke { opacity: .25; }
.overlay.crack { opacity: .12; }
.overlay.vignette { opacity: .7; }

.glyph-blink {
  position: absolute;
  color: rgba(182, 236, 255, 0.98);
  text-shadow: 0 0 22px rgba(134, 217, 255, 0.95), 0 0 54px rgba(88, 162, 255, 0.75);
  font-size: clamp(64px, 6.6vw, 92px);
  line-height: 1;
  font-weight: 700;
  font-family: 'Noto Sans Thai', 'Noto Sans TC', sans-serif;
  transform: translate(-50%, -50%);
  animation: glyphPulse 1.1s ease-in-out infinite;
  pointer-events: none;
}

.live-header {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  z-index: 40;
  pointer-events: none;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 14px;
  background: rgba(0, 0, 0, .35);
  backdrop-filter: blur(4px);
  padding: 10px 12px;
  border-radius: 10px 10px 0 0;
}
.live-header h1 {
  margin: 0;
  flex: 1;
  text-align: center;
  font-size: 20px;
}

.live-tag {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  font-weight: 700;
  letter-spacing: 0.5px;
  color: #ff5c5c;
  white-space: nowrap;
}

.live-tag::before {
  content: '';
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #ff4343;
  box-shadow: 0 0 10px rgba(255, 67, 67, 0.8);
  animation: livePulse 1.2s ease-in-out infinite;
}

.viewer-count {
  font-size: 14px;
  color: #dbe7ff;
  white-space: nowrap;
}

.curse-meter { display: flex; align-items: center; gap: 8px; margin-top: 8px; }
.curse-meter .bar { width: 140px; height: 8px; background: #262b38; border-radius: 99px; overflow: hidden; }
.curse-meter .fill { height: 100%; background: linear-gradient(90deg,#62d2a2,#f2a347,#ed4b6a); }

.chat-panel {
  background: #111316;
  border: 1px solid #2b2d31;
  border-radius: 12px;
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
  overflow: hidden;
  position: relative;
}
.chat-header {
  display: flex;
  align-items: center;
  padding: 10px 12px;
  border-bottom: 1px solid #2b2d33;
  font-size: 13px;
  background: #1a1c21;
}

.chat-list {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding: 10px 12px 8px;
  display: flex;
  flex-direction: column;
  scrollbar-width: thin;
}

.chat-items {
  margin-top: auto;
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.chat-message {
  font-size: 14px;
  line-height: 1.42;
  padding: 3px 2px;
  border-radius: 6px;
}
.chat-message:hover {
  background: rgba(255,255,255,0.03);
}
.chat-line {
  display: flex;
  gap: 6px;
  align-items: flex-start;
}
.name {
  font-weight: 700;
  display: inline-flex;
  align-items: center;
  gap: 5px;
  color: #8ab4f8;
  white-space: nowrap;
}
.msg {
  color: #f1f3f4;
  word-break: break-word;
  flex: 1;
}
.translation-actions {
  margin: 2px 0 0 22px;
}
.translation {
  margin: 3px 0 0 22px;
  color: #9ecbff;
  font-size: 13px;
}
.crown { width: 14px; height: 14px; }
.vip.VIP_NORMAL .name { color: #f7d87b; }
.vip.VIP_STILL_HERE .name { color: #c9b8ff; }
.chat-message.self .name { color: #8cffc4; }
.chat-message.self .msg { color: #dfffea; }

.chat-message.system.join {
  padding: 2px 0;
}

.chat-message.system.join .chat-line {
  justify-content: center;
}

.chat-message.system.join .msg {
  color: #9ca3af;
  font-size: 12px;
}

.chat-message.system.info {
  background: rgba(211, 216, 227, 0.14);
  border: 1px solid rgba(187, 194, 207, 0.28);
  padding: 6px 8px;
}

.chat-message.system.info .chat-line {
  gap: 8px;
}

.system-tag {
  color: #c8ceda;
  font-size: 12px;
  white-space: nowrap;
}

.chat-message.system.info .msg {
  color: #d6dbe6;
  font-size: 12px;
}

.chat-message.donate {
  background: linear-gradient(135deg, rgba(255, 153, 102, 0.24), rgba(250, 111, 182, 0.2));
  border: 1px solid rgba(255, 168, 116, 0.38);
  padding: 8px;
}

.chat-message.donate .name {
  color: #ffd6a6;
}

.donate-badge {
  display: inline-flex;
  align-items: center;
  font-size: 11px;
  padding: 2px 6px;
  border-radius: 999px;
  background: rgba(255, 121, 170, 0.28);
  color: #ffdff0;
  white-space: nowrap;
}

.translation-toggle {
  border: 1px solid #414b64;
  background: transparent;
  color: #c9d8ff;
  font-size: 11px;
  border-radius: 4px;
  cursor: pointer;
  padding: 1px 6px;
}

.jump-bottom {
  position: absolute;
  right: 14px;
  bottom: 72px;
  border: none;
  border-radius: 14px;
  padding: 5px 12px;
  font-size: 12px;
  background: #2f6eff;
  color: #fff;
  cursor: pointer;
  z-index: 2;
}

.chat-input {
  flex: 0 0 auto;
  position: sticky;
  bottom: 0;
  display: flex;
  gap: 8px;
  padding: 8px 12px calc(env(safe-area-inset-bottom) + 8px);
  border-top: 1px solid #2b2d33;
  background: #111;
}

.chat-input-bar {
  will-change: transform;
}
.chat-input input {
  flex: 1;
  background: #0c0e12;
  border: 1px solid #343844;
  border-radius: 18px;
  color: #fff;
  padding: 9px 12px;
}
.chat-input button {
  border: none;
  border-radius: 18px;
  padding: 0 14px;
  background: #3ea6ff;
  color: #071d2d;
  font-weight: 700;
  cursor: pointer;
}

.asset-warning {
  position: absolute;
  left: 14px;
  bottom: 14px;
  background: rgba(117, 24, 24, 0.85);
  color: #ffdcdc;
  border: 1px solid #ff8f8f;
  border-radius: 8px;
  padding: 8px 10px;
  font-size: 12px;
  z-index: 3;
}

.asset-warning code {
  color: #fff;
}
@keyframes loadingSpin {
  to { transform: rotate(360deg); }
}

@keyframes fadein { from { opacity: 0; transform: translateY(-4px);} to { opacity: 1; transform: translateY(0);} }
@keyframes shake {
  0%,100% { transform: translate(0,0); }
  25% { transform: translate(-1px, 1px); }
  75% { transform: translate(1px, -1px); }
}
@keyframes glitch { 0%,100% { opacity: 1; } 50% { opacity: .65; } }
@keyframes glyphPulse { 0%,100% { opacity: .2; } 40% { opacity: 1; } 70% { opacity: .35; } }
@keyframes livePulse {
  0%, 100% { transform: scale(1); opacity: 0.8; }
  50% { transform: scale(1.35); opacity: 1; }
}

.scene-view .curse-low.overlay.noise { opacity: .14; }
.distortion-overlay { z-index: 2; }
.filter-layer.curse-mid { filter: blur(1px); transform: scale(1.01); }
.scene-view .curse-mid.overlay.noise { opacity: .25; }
.filter-layer.curse-high { filter: blur(2px); transform: scale(1.015); }
.scene-view .curse-high.distortion-overlay { animation: shake .16s infinite; }
.filter-layer.curse-critical {
  filter: blur(2px) hue-rotate(8deg);
  transform: scale(1.02);
}
.scene-view .curse-critical.distortion-overlay {
  animation: shake .12s infinite, glitch .45s infinite;
}

@media (min-width: 900px) {
  .app-layout {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 12px;
  }

  .video-container,
  .chat-container {
    min-height: 0;
  }

  .video-container {
    aspect-ratio: auto;
  }
}

@media (max-width: 899px) {
  .app-shell {
    height: 100dvh;
    height: 100svh;
    overflow: hidden;
  }

  .app-shell {
    padding: 8px;
    gap: 8px;
  }

  .app-layout {
    gap: 8px;
  }

  .scene-view,
  .chat-panel {
    border-radius: 10px 10px 0 0;
  }

  .glyph-blink {
    font-size: clamp(52px, 13vw, 84px);
  }

  .chat-header {
    padding: 9px 10px;
  }

  .chat-input {
    gap: 6px;
  }

  .chat-input input {
    padding: 8px 10px;
  }

  .chat-input button {
    padding: 0 12px;
  }
}

@media (max-width: 768px) {
  .app-layout {
    height: 100%;
    overflow: hidden;
  }

  .live-top {
    position: sticky;
    top: 0;
    z-index: 50;
    background: #000;
    flex: 0 0 auto;
  }

  .chat-container {
    flex: 1;
    min-height: 0;
    overflow: hidden;
  }

  .chat-panel {
    height: 100%;
    border-radius: 10px;
  }

  .chat-list {
    overscroll-behavior: contain;
  }

  .chat-input {
    position: sticky;
    bottom: 0;
    z-index: 60;
    background: #000;
  }
}

.content-warning-overlay {
  position: absolute;
  inset: 0;
  z-index: 60;
  display: grid;
  place-items: center;
  background: rgba(0, 0, 0, 0.62);
}

.content-warning-card {
  width: min(92%, 420px);
  border-radius: 12px;
  border: 1px solid rgba(255, 255, 255, 0.22);
  background: rgba(10, 12, 18, 0.95);
  padding: 16px;
  text-align: center;
}

.content-warning-card p {
  margin: 0 0 12px;
  font-size: 16px;
}

.content-warning-actions {
  display: flex;
  justify-content: center;
  gap: 10px;
}

.content-warning-actions button {
  border: 1px solid rgba(255, 255, 255, 0.26);
  background: rgba(255, 255, 255, 0.08);
  color: #fff;
  border-radius: 8px;
  min-width: 72px;
  padding: 7px 10px;
  cursor: pointer;
}

.content-warning-card small {
  display: block;
  margin-top: 10px;
  color: rgba(255, 255, 255, 0.75);
}
